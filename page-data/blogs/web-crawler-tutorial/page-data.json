{"componentChunkName":"component---src-templates-blog-details-js","path":"/blogs/web-crawler-tutorial","result":{"data":{"markdownRemark":{"html":"<h1>üî•üî• Web Crawler Tutorial üî•üî•</h1>\n<blockquote>\n<p>An automated script for retrieving data from web or sending request to web servers.</p>\n</blockquote>\n<blockquote>\n<p>üí° Disclaimer : Only for education purpose, do not do anything against law.</p>\n</blockquote>\n<p>Github : <a href=\"https://github.com/atosystem/webcrawler_tutorial\">Link</a></p>\n<h2>üõ†Ô∏è Tools for Crawling</h2>\n<ul>\n<li><a href=\"https://curl.se/\">curl</a> (low level)</li>\n<li>python\n<ul>\n<li><a href=\"https://pypi.org/project/requests/\">requests</a></li>\n<li><a href=\"https://pypi.org/project/beautifulsoup4/\">beautifulsoup</a> (for parsing HTML,XML)</li>\n<li><a href=\"https://pypi.org/project/selenium/\">selenium</a> (simulate web browser)(Less investigating effort but low effeciency)</li>\n</ul>\n</li>\n</ul>\n<h2>üìñ Background Knowledge</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.84662576687117%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQoz42S246CMBCGff83whsTGyKSeGEI0huNBhCiIUAKPUxPu0td0D2w+121F9/MP+0slFKEEAAwxth/oLUmhLRtK6VcSCndyVqrlHKHebnruqZpAGBhraWUFkVxv9/P5zPGuK5r8QpjDADkgEtKKbXWfsh93wdB4A0ghMqytNaaT6y1AKCUGptLKYUQkxyG4XK59Dxvt9thjOM45py7Em4crfVzcgB4yIyx4/EYRVEcx/v9/nK51HX9POcXWSk1yX3fc87VgGtljAEAIUTbtlVVUUq11uMgL7EJIe6S53mSJFEU5XkuhHAlGGOu6AgbeMicc5fqdDqtViuEkO/7YRhijJum+f5bQojptRljo7xer4Mg8H0/SZKiKLIsc+P9LWdZdjgc+MDMwr3IY+yyLLfb7e12ywbSNP3e1snTzGPnNE0RQlVVzW/oz7Gv1+tms+m6zvyOSzrJ7lfGvdNay1ncCrzLb1KgX32HXPmhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"web request and response\"\n        title=\"web request and response\"\n        src=\"/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/a6d36/webrequest_response.png\"\n        srcset=\"/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/222b7/webrequest_response.png 163w,\n/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/ff46a/webrequest_response.png 325w,\n/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/a6d36/webrequest_response.png 650w,\n/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/167b5/webrequest_response.png 776w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n(picture from <a href=\"https://www.oreilly.com/library/view/restful-java-web/9781788294041/1889f99d-f907-41c3-a0f0-925bbf1d3825.xhtml\">Understanding the HTTP request-response model</a>)</p>\n<ul>\n<li>web requests and response</li>\n<li>stateless</li>\n</ul>\n<blockquote>\n<p>Usefull website for discovering : <a href=\"https://reqbin.com/req/nfilsyk5/get-request-example\">get-request-example</a></p>\n</blockquote>\n<h2>üí° Main Idea</h2>\n<p>The data appeared on webpage is fetched from backend server via our web browser when we visit a url or we trigger some event on the webpage. To fetch data automatically, we simulate the same action our browser does.</p>\n<h3>Steps</h3>\n<ol>\n<li>Observe the mechanism of the target website</li>\n<li>Write code to simulate user request</li>\n</ol>\n<p><em>Most of the time, you will do the two steps repeatedly</em></p>\n<h2>üë∑ Exercise 1</h2>\n<p>URL : <a href=\"http://www.example.com\">http://www.example.com</a></p>\n<h3>Use Google Chrome to Investigate</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.601226993865026%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIklEQVQoz4WSXWsUMRSG52eo7O58f2Uyk9nM506pFKF6UUHwohfi7+3a2lorxZvilV7UutOplm52XMwrE0QWBBt4L3ISHp6TE+3m5gcWi2u0bYfb2zus178wrNPTM/hBBMZLFHmFNE7heQR1OcOs3kJVNijyGkVRI+UFGGModl5Au7j4hKOjtzg5OcX5+UdcXl6h79d4//4DvIAijBgSloHWW/DqGUjTgDYzeHkGN+dwOUdIKDzbQv74ObSrbx0+f/mqLBeLFl33XRmenZ3DcQN1mVAGknJ4NIZNGUYRh5XWcLIGDm9gJxXGLkX1dB/a3XKF5bLHavVTmS2XKwU8Pn73BxiDxgzTaY44ikGmNdizVwie7MPZfolJtYdRuYeH2S7i3dfQuusbXG9kMBWix8HBGwUkUaLecqJbGE1MWJaLqsiR8SkSGsO1HZi6Af3RA5BsB9owlM0M0MF0Pj/8CwxCCtNyoRu2quXlDISmsJwAhuWp6LoJl21DG95sM8O0/we0HR9l1YDnFfyQwjAd6IYDQzdgRfW/hvcBh1qWV2DTXE3f84kCmoYJI8gVUG6mbTvZ92s5nx9Kxw0kiRIZhFSalit1w5a240uelTJmXJ0P+4lhS0M35NhJ5f0tk1gZDnbjiala5lmJiDLV8mCo/msYYewkylBspm070fdrMZ8fCtcLBYkSEZJYhUSxCEIqWJqpRDQVnk+E50ciCMhyZJL+N1h89xHyzayaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mJNKpPV\"\n        title=\"mJNKpPV\"\n        src=\"/static/e07b489e6c1ec4dfad13d1649ce6ffa9/a6d36/mJNKpPV.png\"\n        srcset=\"/static/e07b489e6c1ec4dfad13d1649ce6ffa9/222b7/mJNKpPV.png 163w,\n/static/e07b489e6c1ec4dfad13d1649ce6ffa9/ff46a/mJNKpPV.png 325w,\n/static/e07b489e6c1ec4dfad13d1649ce6ffa9/a6d36/mJNKpPV.png 650w,\n/static/e07b489e6c1ec4dfad13d1649ce6ffa9/e548f/mJNKpPV.png 975w,\n/static/e07b489e6c1ec4dfad13d1649ce6ffa9/3c492/mJNKpPV.png 1300w,\n/static/e07b489e6c1ec4dfad13d1649ce6ffa9/5e6a4/mJNKpPV.png 1469w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\nOpen the Developer Tools, we can see the request made by our browser when we enter the url.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 114.11042944785277%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAADlklEQVQ4y42V3W7jNhCF/RZtGluy/iWKIinqz3LsOHbipttdFCjQ3nTv+v7v8BVk7GyKpsFeDIY0zTNn5gxHC1Er+mFis9nSqJb9/QOVkNzeLonjmB9+vGGctthu9OfjNOPulJX8j1WiYZGkOUJqhv0jbTeidesPgzAiXCesnUUJUZxeLHvX3H+VMiySJKeoNdXmSKYGsrJGSu2j1VKTlpKkUkRJfgFPX4O8+iglCGMapVmkWUleCNZRRiYtQvfYfuOjTZ2lrDVhJgjjnFUQswxigjBhFSYE6xfv7DaIkI12KRdkWUlcSKrdL3S7M/Phmf3dnlOvuB8sU9ezMYqhG5g3O2ajuLcNs5ZsVM2hU2x1zTx0LwyLsibNK8aHJ9SwZ5h2PNiGY6cwylDKllpIjKiwskZVpV/LoqApS3RV0hQFg7UsXLpOlChcM1hN+/SJZr5HDDOZ7pCNoR825KXk5jbkZhn69G5WMT9dzK1vlhG1VA6w8sVf3obEQnP39W+2X35n2O5JhaJQlqYqEGXh1XcB8rxCljlaOIYvvsoztDYvDB2ykz3JStJKktSaqBBk0lCYjqbMqMvc958ylqIQqCrH1oUHc14UbwArocjTlE5LMqG8SHWtCMOYYLV+VXIVRCxXa98iS69s4r1fr2Iap7IDlMqwWoZktWb+8yvTwxOff/3CMM6+aR2A77//sShKfXDZKBZZXvlUVisHqJj/+Av7/IXx/Ak975k2d0zT1tdvFca+NG/tCurWWVZca6gJgohUNOjjz6jjM83+RD9tOR6f6PoRqVp6WTL2Pcp0tHa4PNH4FTBN80vb1Io4Tui6gcZ0mNay3z9gbe8vxHGGewBpkpKmhRfP7eMkf2X5L8ArQ1fD9vRMvztw+vwb3d3BB3ONH1zSDT5I+RtDqcnTjJ2tUcaQtyOZHSmVZd7uPOjby2/tfYaN9pPDVBlDq1GHJ2Q/0bY9thu80h+p/G4NnYJBEBPnAvVwRnWjV9d1wdvCf8T0G8NaEaUllRlJhfY96Qasa+S3YN/NsNGWzEzkZiJKK9bfkeJ7lmYOMK/Q/YZqPhElBeF19LuobhI7ZV05wtgzvpp7gtcMrvskzS4MVUtUKuz9mcfHM6fHM4fDkfHugB53VJcPkJs0SrV+mJi293s/MLRFm46yEiyKUqBNi9Kabhjpuo5xnLC28+u+7+n7wZ83jUIp5xuMMTRKIWXjf3OTRgjBP4jlqhIsMcPLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"dyrXFPX\"\n        title=\"dyrXFPX\"\n        src=\"/static/b632a6f77196a696f77c8f9c37404d50/a6d36/dyrXFPX.png\"\n        srcset=\"/static/b632a6f77196a696f77c8f9c37404d50/222b7/dyrXFPX.png 163w,\n/static/b632a6f77196a696f77c8f9c37404d50/ff46a/dyrXFPX.png 325w,\n/static/b632a6f77196a696f77c8f9c37404d50/a6d36/dyrXFPX.png 650w,\n/static/b632a6f77196a696f77c8f9c37404d50/e548f/dyrXFPX.png 975w,\n/static/b632a6f77196a696f77c8f9c37404d50/b12f7/dyrXFPX.png 1020w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\nThe response is the html code of the webpage showed in our browser.</p>\n<p>Now let's do it in python!</p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">import requests\n\n# (not very important) these data provide web server with our device information. (though some website may check this part)\nUSER_AGENT = &#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1&#39;\n\nCRAWL_URL = &#39;http://www.example.com&#39;\n\nsession = requests.Session()\nsession.headers = {&#39;user-agent&#39; : USER_AGENT}\n\nreq = session.get(CRAWL_URL)\n\nprint(req.text)</code>\n        </deckgo-highlight-code>\n<p>The results should be the same as the response in web browser.</p>\n<deckgo-highlight-code language=\"html\"  >\n          <code slot=\"code\">&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Example Domain&lt;/title&gt;\n\n    &lt;meta charset=&quot;utf-8&quot; /&gt;\n    &lt;meta http-equiv=&quot;Content-type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;\n    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;\n    &lt;style type=&quot;text/css&quot;&gt;\n    body {...</code>\n        </deckgo-highlight-code>\n<p>In the python script,</p>\n<ul>\n<li><code>session</code> help us to save the state of the connection (cookie...). Usually the browser does the job. Notice that web request itself is stateless, so we need to use other methods to save our state information.</li>\n<li><code>session.get</code> we use <code>GET</code> method here. <code>GET</code>,<code>POST</code>,<code>PUT</code>,<code>DELETE</code> are the 4 common methods in http protocal.</li>\n</ul>\n<h2>üë∑ Exercise 2</h2>\n<p>Let's crawl and parse html page!\nURL : <a href=\"https://web.ee.ntu.edu.tw/\">https://web.ee.ntu.edu.tw/</a></p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">import requests\nfrom bs4 import BeautifulSoup\n\n# (not very important) these data provide web server with our device information. (though some website may check this part)\nUSER_AGENT = &#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1&#39;\n\nCRAWL_URL = &#39;https://web.ee.ntu.edu.tw/&#39;\n\nsession = requests.Session()\nsession.headers = {&#39;user-agent&#39; : USER_AGENT}\n\nreq = session.get(CRAWL_URL)\n\n# using BeautifulSoup to parse html\nsoup = BeautifulSoup(req.text, &#39;html.parser&#39;)\n\n# select elements by class name\nelement_honor_box = soup.find_all(class_=&quot;honor_box&quot;)[0]\n\nhonor_title = element_honor_box.find_all(class_=&quot;honor_title&quot;)\nhonor_content = element_honor_box.find_all(class_=&quot;honor_content&quot;)\n\nfor h in honor_content:\n    # remove child element\n    element_a = h.find(&#39;a&#39;)\n    element_a.decompose()\n\nprint(&quot;Ê¶ÆË≠ΩÊ¶ú&quot;)\nfor i in range(len(honor_content)):\n    print(&quot;{} - {}&quot;.format(honor_title[i].string,honor_content[i].string))</code>\n        </deckgo-highlight-code>\n<h2>‚ô•Ô∏èIG Web Crawler</h2>\n<p>The scenario is more difficult for authentication websites.</p>\n<h3>Concept</h3>\n<ul>\n<li>csrftoken : Cross-site request forgery(CSRF)\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.32515337423312%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQ4y41T3cqCQBDdt+yl6hXsIfIJJLzrSjIzgywrsF9FBd3a8zEDhi5rXwPLWRnnOOfMKABAKfX1vN9vRj30HKFoL13sFpgITB9on4WeaJoGUkpGijRNEccx6rpm9DwPQRDgfD4z8el0Yux1eLvdYFkWLpcLwjBEFEXYbrfYbDZwXZfPYrHg/OFwwH6/x/P5hG3bGI1GXENBxEx4PB4xnU5xvV458Xq9PtIcx8FsNuNOdrsdkxES8XK5xGQywXq97hOWZYk8zxl1T6gT6kz3q6lrvpM99M6gh98m6/s+y5OkoLMF3VphWps2qqpiiXSyLIO/WiGOIuB+h0pTKCmhtC0RptEXRcGTJC8fjweSJOnbQfeqItN6hCzZREjF4/H4M702eks8sKtGQpr2fD5nqV1LBu35r0OanD4kUzemEKb/0xS/kA12qEv6lYwI/wBQCj6MZD2rOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image alt\"\n        title=\"image alt\"\n        src=\"/static/0d093573ea5814da8b157a20da806fa0/a6d36/form-handling-with-anti-csrf-protection.png\"\n        srcset=\"/static/0d093573ea5814da8b157a20da806fa0/222b7/form-handling-with-anti-csrf-protection.png 163w,\n/static/0d093573ea5814da8b157a20da806fa0/ff46a/form-handling-with-anti-csrf-protection.png 325w,\n/static/0d093573ea5814da8b157a20da806fa0/a6d36/form-handling-with-anti-csrf-protection.png 650w,\n/static/0d093573ea5814da8b157a20da806fa0/e548f/form-handling-with-anti-csrf-protection.png 975w,\n/static/0d093573ea5814da8b157a20da806fa0/3c492/form-handling-with-anti-csrf-protection.png 1300w,\n/static/0d093573ea5814da8b157a20da806fa0/0e904/form-handling-with-anti-csrf-protection.png 1384w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\nImage from <a href=\"https://kmfinfotech.com/blog/wp-content/uploads/2021/01/form-handling-with-anti-csrf-protection.png\">kmfinfotech.com</a>\nprevent invalid request via token generated from server</li>\n</ul>\n<h3>Login Instagram</h3>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">import requests\nimport json\n\nBASE_URL = &#39;https://www.instagram.com/&#39;\nLOGIN_URL = BASE_URL + &#39;accounts/login/ajax/&#39;\n\nUSERNAME = &quot;&lt;your email address or username&gt;&quot;\nPASSWORD = &quot;&lt;your encoded password&gt;&quot;\n\nUSER_AGENT = &#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1&#39;\n\nig_userID = 0\n\nsession = requests.Session()\nsession.headers = {&#39;user-agent&#39; : USER_AGENT}\nsession.headers.update({&#39;Referer&#39; : BASE_URL,&#39;X-IG-Connection-Type&#39;: &#39;WIFI&#39;})\n\nreq = session.get(BASE_URL)\n# we need to update our request header &#39;x-csrftoken&#39; to the csrftoken server generated for us to prepare for our next request\nsession.headers.update({&#39;x-csrftoken&#39;:req.cookies[&#39;csrftoken&#39;]})\n\nlogin_data = {&#39;username&#39; : USERNAME, &#39;enc_password&#39; : PASSWORD}\n\n\nreq_login = session.post(LOGIN_URL,data=login_data,allow_redirects = True)\nsession.headers.update({&#39;x-csrftoken&#39;:req_login.cookies[&#39;csrftoken&#39;]})\n\nprint(req_login.text)\n\nig_userID =json.loads(req_login.text)[&#39;userId&#39;]\nprint(&quot;UserID = &quot; + ig_userID)</code>\n        </deckgo-highlight-code>\n<p>If you login sucessfully, you should see your Instagram ID.</p>\n<p>Instagram uses enc_password to send our password to their server. We can get the enc_password by google chrome developers tool.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.601226993865026%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACS0lEQVQoz1WTy27TQBSG8yJN0/g2vjuOHTutStfwBLxWkYIErJHaJKjsu+EFEAsEEaVFsKioWghpQnOx03xoJqWIkX6NRyN//v9zjiuz2Qyp0WikNJmMkevg4ADNEDTTNkma47g+wvbIsjZZvk0ra5O2ctJWm7iRkiYt/KBBZVmWFOWS0y9fef/hIz+GIwXs9frU6iZeEBNECXG2S9TaIdneI27v4SfbCDfEEi7CDzAdFz+IqZRlyfzmN9PRCIoSikIBD7s9qpt15czxIqwwQ/dTNBFQNwSO30A4PqblYAqHum5iWB4VbkvefJvTeTvm5WDO83fXTIFX/T7VmoawXZJ8l9ajx2zlDzGjNmEQEcWpkowpS2GYDpZwqNyWBZfTFYOrBZ8uZ5wO1w673R4b1S1sx8d1A0zdYHNjA0M3aSYZjhuoe5lis6Yp6YZFpShLmE1ZXHxnfnHB8ufVPbCumUSNBMv2qNZ0Jd20VSOiRorjhthOgLB9DOvOYVEUSI2vxwx/XTOZ3NwB+2i6IG62lMvalq5cGKZNlu8QJ7lqgu0GKq5uCExTUFksFvxdt6v7Rw4PuyqSjCY7+Q8o1Lg0kxzXj9B0S8Hkx1Xk1WrF8fExTzsdOi+e8WR/n+FwyNHRawV0vfA/oOyqrKF0GDczPL9xH912vLXD8/NzTk5O+Hx2xsfBgOWypNvr3wEDBZEweZaR29sPiOIWfhjjBQ21S6jnh2ugnEW5z6Yz5vP5uoa9PnXNIoyaKrYcHynpQv4p8mXZ4VpNU1qXx+cPBq/xFEiBAf0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"p3My5nG\"\n        title=\"p3My5nG\"\n        src=\"/static/40f22a96f67dcff10a924ab083d58522/a6d36/p3My5nG.png\"\n        srcset=\"/static/40f22a96f67dcff10a924ab083d58522/222b7/p3My5nG.png 163w,\n/static/40f22a96f67dcff10a924ab083d58522/ff46a/p3My5nG.png 325w,\n/static/40f22a96f67dcff10a924ab083d58522/a6d36/p3My5nG.png 650w,\n/static/40f22a96f67dcff10a924ab083d58522/e548f/p3My5nG.png 975w,\n/static/40f22a96f67dcff10a924ab083d58522/3c492/p3My5nG.png 1300w,\n/static/40f22a96f67dcff10a924ab083d58522/d9ed5/p3My5nG.png 2880w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\nHowever, the encoding string has something to do with timestamp, so the best way is to generate the encoding ourself every time we want to send the login request. For more information about the encoding that instagram made, checkout github forum. Some geeks are working on it.</p>\n<h3>Get Instagram Feed</h3>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">req_feed = session.get(BASE_URL)\nsession.headers.update({&#39;x-csrftoken&#39;:req_feed.cookies[&#39;csrftoken&#39;]})\n\nraw_content = req_feed.text\n\n# parse data by treating some keywords as position anchor\nCONFIG_KEYWORD = &quot;window._sharedData = &quot;\nconfig_start_pos = raw_content.find(CONFIG_KEYWORD) + len(CONFIG_KEYWORD)\nconfig_end_pos = raw_content.find(&quot;&lt;/script&gt;&quot;,config_start_pos) - 1\n\nFEED_KEYWORD = &quot;window.__additionalDataLoaded(&#39;feed&#39;,&quot;\nfeed_start_pos = raw_content.find(FEED_KEYWORD,config_end_pos) + len(FEED_KEYWORD)\nfeed_end_pos = raw_content.find(&quot;&lt;/script&gt;&quot;,feed_start_pos) - 2\n\ndata_config = json.loads(raw_content[config_start_pos:config_end_pos])\ndata_feed = json.loads(raw_content[feed_start_pos:feed_end_pos])\n\n# save data to files\nfp = codecs.open(&#39;data_config.json&#39;, &#39;w&#39;, &#39;utf-8&#39;)\nfp.write(json.dumps(data_config,ensure_ascii=False))\nfp.close()\n\nfp = codecs.open(&#39;data_feed.json&#39;, &#39;w&#39;, &#39;utf-8&#39;)\nfp.write(json.dumps(data_feed,ensure_ascii=False))\nfp.close()</code>\n        </deckgo-highlight-code>\n<h3>Like/Unlike a post</h3>\n<h4>Like</h4>\n<p>After Pressing Like Button:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.93865030674846%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVQ4y31Ty47TQBD0h7BJHNtrJ37P23YCq8CFA0JCAiGBuPL/X1CoeuLdZLXiUOrumU51VXuSnL/+wf78DfX0CX3boGk7hGnGPJ8QpkXgw4RJ8hmjMlCEttC3MFbuki+//2L4/AuNf8LHywXLcobzM4wLsC7A+Ulqxmk+CTiEhF03oOvHZwyDQvLzx3e8XyZUZQljA6blBOUd8vyANHvELs2x3WUS032BXVpIvtlmeNikz3j3kCLLHpF8eLqgeKwEPixC2I8aTTuiHw3Kqhak+0i8gqS32O5y5EWJZLPdy4S8qOD9LJaUsmi7EU07oCiPyPIS+6va/4FDEzZyIu0Y6+FDJJ2XM6ybMCgHbSdRzOGrunu1MaZpjoRELEistYM2XqwSo3Zoe32tLcpDc7fTW/tR1A0hozZOlA2jkZpD+GHWPCuqN9S91K8UFlDGy4fRNqDrldhsuhFtp9ANOqLXaPtYM/KubgZ0g8Gxbu8V0poyAdYv0CbIAJIbN8s581F7WYWxk9TrOfdcN/1rQgsXTnLJHzIaF7HuVJlIQkJ+MA7j+ahcJFyfAwlpj0SDsmJJGkWRF7WSKxcVuvnaE/sphnVCMr5DRu5nUO5KEK2vOQlW6yt4L5ZNtEwXCf+DfMTVocbh2IrsY93FvH3JCT501lw+I3vv+xr8A2fqrIWnr3LdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"JFkf5jJ\"\n        title=\"JFkf5jJ\"\n        src=\"/static/aa71c22b74b138cff97dd6faad0f0148/a6d36/JFkf5jJ.png\"\n        srcset=\"/static/aa71c22b74b138cff97dd6faad0f0148/222b7/JFkf5jJ.png 163w,\n/static/aa71c22b74b138cff97dd6faad0f0148/ff46a/JFkf5jJ.png 325w,\n/static/aa71c22b74b138cff97dd6faad0f0148/a6d36/JFkf5jJ.png 650w,\n/static/aa71c22b74b138cff97dd6faad0f0148/e548f/JFkf5jJ.png 975w,\n/static/aa71c22b74b138cff97dd6faad0f0148/3c492/JFkf5jJ.png 1300w,\n/static/aa71c22b74b138cff97dd6faad0f0148/b8bf8/JFkf5jJ.png 1728w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\"># like\nPOST_ID = &lt;postID&gt;\nLIKE_URL = &quot;https://www.instagram.com/web/likes/{}/like/&quot;.format(POST_ID)\n\nreq_like = session.post(LIKE_URL,allow_redirects = True)\nsession.headers.update({&#39;x-csrftoken&#39;:req_like.cookies[&#39;csrftoken&#39;]})\nprint(req_like.text)</code>\n        </deckgo-highlight-code>\n<h4>Unlike</h4>\n<deckgo-highlight-code language=\"python\"  >\n          <code slot=\"code\">POST_ID = &lt;postID&gt;\nUNLIKE_URL = &quot;https://www.instagram.com/web/likes/{}/unlike/&quot;.format(POST_ID)\nreq_unlike = session.post(UNLIKE_URL,allow_redirects = True)\nsession.headers.update({&#39;x-csrftoken&#39;:req_unlike.cookies[&#39;csrftoken&#39;]})\nprint(req_unlike.text)</code>\n        </deckgo-highlight-code>\n<h2>üíØ Conclusion</h2>\n<ol>\n<li>Concept of web crawler</li>\n<li>Concept of web request and response</li>\n<li>Implementation of crawler in python</li>\n<li>Parsing html code in python</li>\n<li>Concept of CSRF token</li>\n<li>Hands-on experiment on instagram crawling.</li>\n</ol>\n<h2>üöÄ Some Directions For Futher Projects</h2>\n<ol>\n<li><a href=\"https://github.com/VeNoMouS/cloudscraper\">cloudscraper</a></li>\n<li>Posting Instagram Feed</li>\n<li>Crawl Other Website</li>\n<li>Hack the Encryption of instagram login</li>\n</ol>","frontmatter":{"stack":"HTML & python","title":"Web Crawler Tutorial","featuredImg":null}}},"pageContext":{"slug":"web-crawler-tutorial"}},"staticQueryHashes":["2366270877","3151475382","63159454"]}
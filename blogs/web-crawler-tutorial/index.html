<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.d734f5fdcf99010a2b45.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=Baloo+2&display=swap);@import url(https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap);.navbar-module--nav_container--2_Hew{align-items:center;background-color:rgba(255,255,255,.9);display:flex;flex-direction:row;font-family:Baloo\ 2;height:50px;justify-content:space-between;left:0;position:fixed;right:0;top:0;width:100%;z-index:300}.navbar-module--nav_title_container--2b4UX{font-size:30px;margin:10px}.navbar-module--nav_links_container--3ofAj{display:flex;margin:10px}.navbar-module--nav_links--cyTds{color:#000;display:block;margin:10px;padding:.2em 0;position:relative;-webkit-text-decoration-line:none;text-decoration-line:none}.navbar-module--nav_links--cyTds:after{background-color:#680436;bottom:0;content:"";height:.1em;left:0;opacity:0;position:absolute;transition:opacity .3s,-webkit-transform .3s;transition:opacity .3s,transform .3s;transition:opacity .3s,transform .3s,-webkit-transform .3s;width:100%}.navbar-module--nav_links--cyTds:focus:after,.navbar-module--nav_links--cyTds:hover:after{opacity:1;-webkit-transform:translate3d(0,.2em,0);transform:translate3d(0,.2em,0)}.navbar-module--nav_links--cyTds:after{opacity:1;-webkit-transform:scale(0);transform:scale(0);-webkit-transform-origin:center;transform-origin:center}.navbar-module--nav_links--cyTds:focus:after,.navbar-module--nav_links--cyTds:hover:after{-webkit-transform:scale(1);transform:scale(1)}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;box-sizing:border-box;font:112.5%/1.45em georgia,serif,sans-serif;overflow-y:scroll}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;word-wrap:break-word;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt";background-color:#cecece;color:rgba(0,0,0,.8);font-family:Noto Sans TC,sans-serif;font-kerning:normal;font-weight:400;margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help;text-decoration:none}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{text-rendering:optimizeLegibility;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-size:2.25rem;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none;margin:0 0 1.45rem;max-width:100%;padding:0}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace;font-size:1em}figure{margin:0 0 1.45rem;padding:0}hr{background:rgba(0,0,0,.2);border:none;box-sizing:content-box;height:1px;margin:0 0 calc(1.45rem - 1px);overflow:visible;padding:0}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 0 1.45rem;padding:0}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*,:after,:before{box-sizing:inherit}h2{font-size:1.62671rem}h2,h3{text-rendering:optimizeLegibility;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0}h3{font-size:1.38316rem}h4{font-size:1rem}h4,h5{text-rendering:optimizeLegibility;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0}h5{font-size:.85028rem}h6{text-rendering:optimizeLegibility;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-size:.78405rem;font-weight:700;line-height:1.1}h6,hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem;padding:0}dd,dl,p{padding:0}dd,dl,p,pre{margin:0 0 1.45rem}pre{word-wrap:normal;background:rgba(0,0,0,.04);border-radius:3px;font-size:.85rem;line-height:1.42;overflow:auto;padding:1.45rem}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;margin:0 0 1.45rem;padding:0;width:100%}blockquote{margin:0 1.45rem 1.45rem;padding:0}address,form,iframe,noscript{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}td,th,thead{text-align:left}td,th{font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";border-bottom:1px solid rgba(0,0,0,.12);padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{content:" ";letter-spacing:-.2em}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}.body_container{align-content:center;background-color:rgba(255,255,255,.9);display:flex;flex-direction:column;justify-content:center;margin:auto;opacity:100%;padding:10px;width:80%}.body_container>*{background-color:transparent}.index-module--profolio_container--1yRd0{align-content:space-between;display:flex;justify-content:space-between}.index-module--profolio_left--2Syre{flex-basis:35%;flex-shrink:1;text-align:center}.index-module--profolio_left_content--2lJHE{align-content:center;display:flex;flex-direction:column;justify-content:flex-start;margin-top:10%;text-align:center}.index-module--profolio_right--2NWMG{flex-basis:65%;flex-shrink:1}.index-module--profolio_right_content--2BeMZ{margin-top:10%}.index-module--head_image_cropper--l-uox{border-radius:50%;margin-left:auto;margin-right:auto;overflow:hidden;width:50%}.index-module--outter_links_container--19qkh{align-content:flex-start;display:flex;flex-direction:column;font-size:medium;justify-content:flex-start;margin-left:auto;margin-right:auto;text-align:left}.index-module--outter_links_div--ipQfr{align-items:center;display:flex;flex-direction:row;margin-top:2px}.index-module--outter_links_div--ipQfr a{align-items:center;color:#000;display:flex;justify-content:center;text-decoration:none}.index-module--outter_links_div--ipQfr div{margin-left:5px}.index-module--outter_links_div--ipQfr a div:hover{text-decoration:underline}.index-module--section_div--2gkkm{display:flex}.index-module--section_div--2gkkm h3{margin-right:3px}.index-module--name_div--3YSBD{margin-bottom:5px;margin-top:5px}.index-module--name_div--3YSBD .index-module--fordesktop--sVOHS{display:block}.index-module--name_div--3YSBD .index-module--formobile--tBASA{display:none}.index-module--blog_li--2SIpW>:first-of-type{display:block}.index-module--blog_li--2SIpW>:nth-of-type(2){display:none}@media (max-width:640px){.index-module--name_div--3YSBD .index-module--fordesktop--sVOHS,.index-module--outter_links_div--ipQfr a div{display:none}.index-module--name_div--3YSBD .index-module--formobile--tBASA{display:block}.index-module--blog_li--2SIpW>:first-of-type{display:none}.index-module--blog_li--2SIpW>:nth-of-type(2){display:block}}.index-module--blog_item_card--3uDke{margin:10px;-webkit-text-decoration-line:none;text-decoration-line:none}.index-module--blog_item_card--3uDke>Chip{opacity:.5}.index-module--blog_item_card_container--1oKxe{display:flex;flex-direction:column}</style><meta name="generator" content="Gatsby 3.9.1"/><title data-react-helmet="true">Blogs-Web Crawler Tutorial | Ian Shih</title><meta data-react-helmet="true" name="description" content="Ian Shih 施貽仁"/><meta data-react-helmet="true" property="og:title" content="Blogs-Web Crawler Tutorial"/><meta data-react-helmet="true" property="og:description" content="Ian Shih 施貽仁"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@yijenshih"/><meta data-react-helmet="true" name="twitter:title" content="Blogs-Web Crawler Tutorial"/><meta data-react-helmet="true" name="twitter:description" content="Ian Shih 施貽仁"/><style data-styled="" data-styled-version="5.3.0"></style><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link as="script" rel="preload" href="/webpack-runtime-8bfdfe929912fb0982bb.js"/><link as="script" rel="preload" href="/framework-be1551205b2666f6b545.js"/><link as="script" rel="preload" href="/app-0b1b4642d04bebea0301.js"/><link as="script" rel="preload" href="/commons-b1815e83bd1939b4b650.js"/><link as="script" rel="preload" href="/36d7c21d1e4b7fa3fc10cf7859aa9fac2846a677-d9991990319625a2a358.js"/><link as="script" rel="preload" href="/9e6ea4d975805858d07c04bb43dd1fddf394f5b1-f46da138f29cb1f8c969.js"/><link as="script" rel="preload" href="/component---src-templates-blog-details-js-824510c1beeaadccc353.js"/><link as="fetch" rel="preload" href="/page-data/blogs/web-crawler-tutorial/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2366270877.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3151475382.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="gbi-1681571932-uSU4YHA5Pgi5qFBY7HPeKz" style="background-position:center;background-repeat:no-repeat;background-size:cover;position:fixed;height:100%;width:100%;opacity:0.99"><style>
          .gbi-1681571932-uSU4YHA5Pgi5qFBY7HPeKz:before,
          .gbi-1681571932-uSU4YHA5Pgi5qFBY7HPeKz:after {
            content: '';
            display: block;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            
            transition: opacity 0.5s ease 250ms;
            background-position: center;
background-repeat: no-repeat;
background-size: cover;

          }
          .gbi-1681571932-uSU4YHA5Pgi5qFBY7HPeKz:before {
            z-index: -100;
            
            
            opacity: 1; 
          }
          .gbi-1681571932-uSU4YHA5Pgi5qFBY7HPeKz:after {
            z-index: -101;
            
            
            
          }
        </style><noscript><style>
    .gbi-1681571932-uSU4YHA5Pgi5qFBY7HPeKz:before {
      opacity: 1;
      background-image: url('/static/ac0c2d2668a020e56521452232cfd890/14b42/mountains.jpg');
    }</style></noscript><div class="navbar-module--nav_container--2_Hew"><div class="navbar-module--nav_title_container--2b4UX"><a style="text-decoration-line:none;color:black" href="/">Ian Shih</a> </div><div class="navbar-module--nav_links_container--3ofAj"><div><a class="navbar-module--nav_links--cyTds" href="/">Home</a></div><div><a class="navbar-module--nav_links--cyTds" href="/about">About</a></div><div><a class="navbar-module--nav_links--cyTds" href="/cv">CV</a></div><div><a class="navbar-module--nav_links--cyTds" href="/blog">Blog</a></div></div></div><div style="padding-top:80px;position:fixed;overflow-y:scroll;top:0;left:0;right:0;bottom:0"><div class="body_container"><main><h2>Blogs-Web Crawler Tutorial</h2><div><div></div><div><h1>🔥🔥 Web Crawler Tutorial 🔥🔥</h1>
<blockquote>
<p>An automated script for retrieving data from web or sending request to web servers.</p>
</blockquote>
<blockquote>
<p>💡 Disclaimer : Only for education purpose, do not do anything against law.</p>
</blockquote>
<p>Github : <a href="https://github.com/ntueecamp/webcrawler_tutorial">Link</a></p>
<h2>🛠️ Tools for Crawling</h2>
<ul>
<li><a href="https://curl.se/">curl</a> (low level)</li>
<li>python
<ul>
<li><a href="https://pypi.org/project/requests/">requests</a></li>
<li><a href="https://pypi.org/project/beautifulsoup4/">beautifulsoup</a> (for parsing HTML,XML)</li>
<li><a href="https://pypi.org/project/selenium/">selenium</a> (simulate web browser)(Less investigating effort but low effeciency)</li>
</ul>
</li>
</ul>
<h2>📖 Background Knowledge</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 74.84662576687117%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQoz42S246CMBCGff83whsTGyKSeGEI0huNBhCiIUAKPUxPu0td0D2w+121F9/MP+0slFKEEAAwxth/oLUmhLRtK6VcSCndyVqrlHKHebnruqZpAGBhraWUFkVxv9/P5zPGuK5r8QpjDADkgEtKKbXWfsh93wdB4A0ghMqytNaaT6y1AKCUGptLKYUQkxyG4XK59Dxvt9thjOM45py7Em4crfVzcgB4yIyx4/EYRVEcx/v9/nK51HX9POcXWSk1yX3fc87VgGtljAEAIUTbtlVVUUq11uMgL7EJIe6S53mSJFEU5XkuhHAlGGOu6AgbeMicc5fqdDqtViuEkO/7YRhijJum+f5bQojptRljo7xer4Mg8H0/SZKiKLIsc+P9LWdZdjgc+MDMwr3IY+yyLLfb7e12ywbSNP3e1snTzGPnNE0RQlVVzW/oz7Gv1+tms+m6zvyOSzrJ7lfGvdNay1ncCrzLb1KgX32HXPmhAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="web request and response"
        title="web request and response"
        src="/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/a6d36/webrequest_response.png"
        srcset="/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/222b7/webrequest_response.png 163w,
/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/ff46a/webrequest_response.png 325w,
/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/a6d36/webrequest_response.png 650w,
/static/330b0f6e7c6d2bac1e0f1c23dff9dd46/167b5/webrequest_response.png 776w"
        sizes="(max-width: 650px) 100vw, 650px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span>
(picture from <a href="https://www.oreilly.com/library/view/restful-java-web/9781788294041/1889f99d-f907-41c3-a0f0-925bbf1d3825.xhtml">Understanding the HTTP request-response model</a>)</p>
<ul>
<li>web requests and response</li>
<li>stateless</li>
</ul>
<blockquote>
<p>Usefull website for discovering : <a href="https://reqbin.com/req/nfilsyk5/get-request-example">get-request-example</a></p>
</blockquote>
<h2>💡 Main Idea</h2>
<p>The data appeared on webpage is fetched from backend server via our web browser when we visit a url or we trigger some event on the webpage. To fetch data automatically, we simulate the same action our browser does.</p>
<h3>Steps</h3>
<ol>
<li>Observe the mechanism of the target website</li>
<li>Write code to simulate user request</li>
</ol>
<p><em>Most of the time, you will do the two steps repeatedly</em></p>
<h2>👷 Exercise 1</h2>
<p>URL : <a href="http://www.example.com">http://www.example.com</a></p>
<h3>Use Google Chrome to Investigate</h3>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54.601226993865026%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIklEQVQoz4WSXWsUMRSG52eo7O58f2Uyk9nM506pFKF6UUHwohfi7+3a2lorxZvilV7UutOplm52XMwrE0QWBBt4L3ISHp6TE+3m5gcWi2u0bYfb2zus178wrNPTM/hBBMZLFHmFNE7heQR1OcOs3kJVNijyGkVRI+UFGGModl5Au7j4hKOjtzg5OcX5+UdcXl6h79d4//4DvIAijBgSloHWW/DqGUjTgDYzeHkGN+dwOUdIKDzbQv74ObSrbx0+f/mqLBeLFl33XRmenZ3DcQN1mVAGknJ4NIZNGUYRh5XWcLIGDm9gJxXGLkX1dB/a3XKF5bLHavVTmS2XKwU8Pn73BxiDxgzTaY44ikGmNdizVwie7MPZfolJtYdRuYeH2S7i3dfQuusbXG9kMBWix8HBGwUkUaLecqJbGE1MWJaLqsiR8SkSGsO1HZi6Af3RA5BsB9owlM0M0MF0Pj/8CwxCCtNyoRu2quXlDISmsJwAhuWp6LoJl21DG95sM8O0/we0HR9l1YDnFfyQwjAd6IYDQzdgRfW/hvcBh1qWV2DTXE3f84kCmoYJI8gVUG6mbTvZ92s5nx9Kxw0kiRIZhFSalit1w5a240uelTJmXJ0P+4lhS0M35NhJ5f0tk1gZDnbjiala5lmJiDLV8mCo/msYYewkylBspm070fdrMZ8fCtcLBYkSEZJYhUSxCEIqWJqpRDQVnk+E50ciCMhyZJL+N1h89xHyzayaAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="mJNKpPV"
        title="mJNKpPV"
        src="/static/e07b489e6c1ec4dfad13d1649ce6ffa9/a6d36/mJNKpPV.png"
        srcset="/static/e07b489e6c1ec4dfad13d1649ce6ffa9/222b7/mJNKpPV.png 163w,
/static/e07b489e6c1ec4dfad13d1649ce6ffa9/ff46a/mJNKpPV.png 325w,
/static/e07b489e6c1ec4dfad13d1649ce6ffa9/a6d36/mJNKpPV.png 650w,
/static/e07b489e6c1ec4dfad13d1649ce6ffa9/e548f/mJNKpPV.png 975w,
/static/e07b489e6c1ec4dfad13d1649ce6ffa9/3c492/mJNKpPV.png 1300w,
/static/e07b489e6c1ec4dfad13d1649ce6ffa9/5e6a4/mJNKpPV.png 1469w"
        sizes="(max-width: 650px) 100vw, 650px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span>
Open the Developer Tools, we can see the request made by our browser when we enter the url.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 114.11042944785277%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAADlklEQVQ4y42V3W7jNhCF/RZtGluy/iWKIinqz3LsOHbipttdFCjQ3nTv+v7v8BVk7GyKpsFeDIY0zTNn5gxHC1Er+mFis9nSqJb9/QOVkNzeLonjmB9+vGGctthu9OfjNOPulJX8j1WiYZGkOUJqhv0jbTeidesPgzAiXCesnUUJUZxeLHvX3H+VMiySJKeoNdXmSKYGsrJGSu2j1VKTlpKkUkRJfgFPX4O8+iglCGMapVmkWUleCNZRRiYtQvfYfuOjTZ2lrDVhJgjjnFUQswxigjBhFSYE6xfv7DaIkI12KRdkWUlcSKrdL3S7M/Phmf3dnlOvuB8sU9ezMYqhG5g3O2ajuLcNs5ZsVM2hU2x1zTx0LwyLsibNK8aHJ9SwZ5h2PNiGY6cwylDKllpIjKiwskZVpV/LoqApS3RV0hQFg7UsXLpOlChcM1hN+/SJZr5HDDOZ7pCNoR825KXk5jbkZhn69G5WMT9dzK1vlhG1VA6w8sVf3obEQnP39W+2X35n2O5JhaJQlqYqEGXh1XcB8rxCljlaOIYvvsoztDYvDB2ykz3JStJKktSaqBBk0lCYjqbMqMvc958ylqIQqCrH1oUHc14UbwArocjTlE5LMqG8SHWtCMOYYLV+VXIVRCxXa98iS69s4r1fr2Iap7IDlMqwWoZktWb+8yvTwxOff/3CMM6+aR2A77//sShKfXDZKBZZXvlUVisHqJj/+Av7/IXx/Ak975k2d0zT1tdvFca+NG/tCurWWVZca6gJgohUNOjjz6jjM83+RD9tOR6f6PoRqVp6WTL2Pcp0tHa4PNH4FTBN80vb1Io4Tui6gcZ0mNay3z9gbe8vxHGGewBpkpKmhRfP7eMkf2X5L8ArQ1fD9vRMvztw+vwb3d3BB3ONH1zSDT5I+RtDqcnTjJ2tUcaQtyOZHSmVZd7uPOjby2/tfYaN9pPDVBlDq1GHJ2Q/0bY9thu80h+p/G4NnYJBEBPnAvVwRnWjV9d1wdvCf8T0G8NaEaUllRlJhfY96Qasa+S3YN/NsNGWzEzkZiJKK9bfkeJ7lmYOMK/Q/YZqPhElBeF19LuobhI7ZV05wtgzvpp7gtcMrvskzS4MVUtUKuz9mcfHM6fHM4fDkfHugB53VJcPkJs0SrV+mJi293s/MLRFm46yEiyKUqBNi9Kabhjpuo5xnLC28+u+7+n7wZ83jUIp5xuMMTRKIWXjf3OTRgjBP4jlqhIsMcPLAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="dyrXFPX"
        title="dyrXFPX"
        src="/static/b632a6f77196a696f77c8f9c37404d50/a6d36/dyrXFPX.png"
        srcset="/static/b632a6f77196a696f77c8f9c37404d50/222b7/dyrXFPX.png 163w,
/static/b632a6f77196a696f77c8f9c37404d50/ff46a/dyrXFPX.png 325w,
/static/b632a6f77196a696f77c8f9c37404d50/a6d36/dyrXFPX.png 650w,
/static/b632a6f77196a696f77c8f9c37404d50/e548f/dyrXFPX.png 975w,
/static/b632a6f77196a696f77c8f9c37404d50/b12f7/dyrXFPX.png 1020w"
        sizes="(max-width: 650px) 100vw, 650px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span>
The response is the html code of the webpage showed in our browser.</p>
<p>Now let's do it in python!</p>
<deckgo-highlight-code language="python"  >
          <code slot="code">import requests

# (not very important) these data provide web server with our device information. (though some website may check this part)
USER_AGENT = &#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1&#39;

CRAWL_URL = &#39;http://www.example.com&#39;

session = requests.Session()
session.headers = {&#39;user-agent&#39; : USER_AGENT}

req = session.get(CRAWL_URL)

print(req.text)</code>
        </deckgo-highlight-code>
<p>The results should be the same as the response in web browser.</p>
<deckgo-highlight-code language="html"  >
          <code slot="code">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Example Domain&lt;/title&gt;

    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta http-equiv=&quot;Content-type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;
    &lt;style type=&quot;text/css&quot;&gt;
    body {...</code>
        </deckgo-highlight-code>
<p>In the python script,</p>
<ul>
<li><code>session</code> help us to save the state of the connection (cookie...). Usually the browser does the job. Notice that web request itself is stateless, so we need to use other methods to save our state information.</li>
<li><code>session.get</code> we use <code>GET</code> method here. <code>GET</code>,<code>POST</code>,<code>PUT</code>,<code>DELETE</code> are the 4 common methods in http protocal.</li>
</ul>
<h2>👷 Exercise 2</h2>
<p>Let's crawl and parse html page!
URL : <a href="https://web.ee.ntu.edu.tw/">https://web.ee.ntu.edu.tw/</a></p>
<deckgo-highlight-code language="python"  >
          <code slot="code">import requests
from bs4 import BeautifulSoup

# (not very important) these data provide web server with our device information. (though some website may check this part)
USER_AGENT = &#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1&#39;

CRAWL_URL = &#39;https://web.ee.ntu.edu.tw/&#39;

session = requests.Session()
session.headers = {&#39;user-agent&#39; : USER_AGENT}

req = session.get(CRAWL_URL)

# using BeautifulSoup to parse html
soup = BeautifulSoup(req.text, &#39;html.parser&#39;)

# select elements by class name
element_honor_box = soup.find_all(class_=&quot;honor_box&quot;)[0]

honor_title = element_honor_box.find_all(class_=&quot;honor_title&quot;)
honor_content = element_honor_box.find_all(class_=&quot;honor_content&quot;)

for h in honor_content:
    # remove child element
    element_a = h.find(&#39;a&#39;)
    element_a.decompose()

print(&quot;榮譽榜&quot;)
for i in range(len(honor_content)):
    print(&quot;{} - {}&quot;.format(honor_title[i].string,honor_content[i].string))</code>
        </deckgo-highlight-code>
<h2>🧡 IG Web Crawler</h2>
<p>The scenario is more difficult for authentication websites.</p>
<h3>Concept</h3>
<ul>
<li>csrftoken : Cross-site request forgery(CSRF)
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69.32515337423312%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUUlEQVQ4y41T3cqCQBDdt+yl6hXsIfIJJLzrSjIzgywrsF9FBd3a8zEDhi5rXwPLWRnnOOfMKABAKfX1vN9vRj30HKFoL13sFpgITB9on4WeaJoGUkpGijRNEccx6rpm9DwPQRDgfD4z8el0Yux1eLvdYFkWLpcLwjBEFEXYbrfYbDZwXZfPYrHg/OFwwH6/x/P5hG3bGI1GXENBxEx4PB4xnU5xvV458Xq9PtIcx8FsNuNOdrsdkxES8XK5xGQywXq97hOWZYk8zxl1T6gT6kz3q6lrvpM99M6gh98m6/s+y5OkoLMF3VphWps2qqpiiXSyLIO/WiGOIuB+h0pTKCmhtC0RptEXRcGTJC8fjweSJOnbQfeqItN6hCzZREjF4/H4M702eks8sKtGQpr2fD5nqV1LBu35r0OanD4kUzemEKb/0xS/kA12qEv6lYwI/wBQCj6MZD2rOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image alt"
        title="image alt"
        src="/static/0d093573ea5814da8b157a20da806fa0/a6d36/form-handling-with-anti-csrf-protection.png"
        srcset="/static/0d093573ea5814da8b157a20da806fa0/222b7/form-handling-with-anti-csrf-protection.png 163w,
/static/0d093573ea5814da8b157a20da806fa0/ff46a/form-handling-with-anti-csrf-protection.png 325w,
/static/0d093573ea5814da8b157a20da806fa0/a6d36/form-handling-with-anti-csrf-protection.png 650w,
/static/0d093573ea5814da8b157a20da806fa0/e548f/form-handling-with-anti-csrf-protection.png 975w,
/static/0d093573ea5814da8b157a20da806fa0/3c492/form-handling-with-anti-csrf-protection.png 1300w,
/static/0d093573ea5814da8b157a20da806fa0/0e904/form-handling-with-anti-csrf-protection.png 1384w"
        sizes="(max-width: 650px) 100vw, 650px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span>
Image from <a href="https://kmfinfotech.com/blog/wp-content/uploads/2021/01/form-handling-with-anti-csrf-protection.png">kmfinfotech.com</a>
prevent invalid request via token generated from server</li>
</ul>
<h3>Login Instagram</h3>
<deckgo-highlight-code language="python"  >
          <code slot="code">import requests
import json

BASE_URL = &#39;https://www.instagram.com/&#39;
LOGIN_URL = BASE_URL + &#39;accounts/login/ajax/&#39;

USERNAME = &quot;&lt;your email address or username&gt;&quot;
PASSWORD = &quot;&lt;your encoded password&gt;&quot;

USER_AGENT = &#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1&#39;

ig_userID = 0

session = requests.Session()
session.headers = {&#39;user-agent&#39; : USER_AGENT}
session.headers.update({&#39;Referer&#39; : BASE_URL,&#39;X-IG-Connection-Type&#39;: &#39;WIFI&#39;})

req = session.get(BASE_URL)
# we need to update our request header &#39;x-csrftoken&#39; to the csrftoken server generated for us to prepare for our next request
session.headers.update({&#39;x-csrftoken&#39;:req.cookies[&#39;csrftoken&#39;]})

login_data = {&#39;username&#39; : USERNAME, &#39;enc_password&#39; : PASSWORD}


req_login = session.post(LOGIN_URL,data=login_data,allow_redirects = True)
session.headers.update({&#39;x-csrftoken&#39;:req_login.cookies[&#39;csrftoken&#39;]})

print(req_login.text)

ig_userID =json.loads(req_login.text)[&#39;userId&#39;]
print(&quot;UserID = &quot; + ig_userID)</code>
        </deckgo-highlight-code>
<p>If you login sucessfully, you should see your Instagram ID.</p>
<p>Instagram uses enc_password to send our password to their server. We can get the enc_password by google chrome developers tool.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54.601226993865026%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACjElEQVQozz2SSWtTURiG8w8cqi7aZr7zlJvhZqgWF4qgoFhR2+K++BuMdURdK1RQ10KbRHTfjX9AXIgWaxVdFEvVmLaa4d40j9zT2g9ezuEceHi/73sjnU6HUK1WS2hra5Ow5ufnScsaea9CwStjmDaablEqVSiVxyiWKnjFMl6xQi7r4RWK2E6WSD8I8IM+K1++8u79B342WwJYrzdIpBQsJ4fjFsiVxnGLRymMHSdXOY5dGEMzM6iaiWY7KIaJ7eSIBEFA9+8f2q0W+AH4vgAu1OrE4inhzLBc1EwJyfZIaw4pWcOws2iGjaIaKJpBSlKQVYsI2wGvv3WZe7PJ86UuT99u0AZeNBrEEmk03aRQHqd4Zopk+TSKWyHjuLg5TyhsMxyFrBiomkFkO/BZbw9Y+tHj43qHleaOw1qtTjSWRDdsTNNBkWTi0SiypJAvlDBMR/yHXcQTaSFJVon4QQCdNr2173TX1uj/+rEHTKUV3GwBVbeIJSQhSdHFItysh2Fm0A0HTbeR1V2Hvu8TanNjk+bvDba2/u4CG6QljVy+KFwmkpJwISs65bFjYvuOm8ewMiiaKd4VVSfS6/X4X9uDvSsLCzXRUthauMn/wLSkYjsupuWKWI2MxhmNJhgeiROLJ4kMBgMWFxd5PDfH3LMnPHr4kGazycuXrwTQtDJ7wGg8hWW7XJ6cZnLqCpcmpzk/cZGz5yY4f+EiJ06e2nG4urrK8vIynz5/5sPSEv1+QK3e2AU6Ihqhu+GRGPl8kXv3H3Dz1h2uVWepXr9BtTrLrdt3mZm5ugMMsxienXaHbre7M8N6g1RaJRPOyXREfMJ4qKohshlPpDhw8DAHh44wdOgI+/YPkUxK/APG3PibF6Am/QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="p3My5nG"
        title="p3My5nG"
        src="/static/fd9b04a49f5a71c62f78bca3cb0c713e/a6d36/p3My5nG.png"
        srcset="/static/fd9b04a49f5a71c62f78bca3cb0c713e/222b7/p3My5nG.png 163w,
/static/fd9b04a49f5a71c62f78bca3cb0c713e/ff46a/p3My5nG.png 325w,
/static/fd9b04a49f5a71c62f78bca3cb0c713e/a6d36/p3My5nG.png 650w,
/static/fd9b04a49f5a71c62f78bca3cb0c713e/e548f/p3My5nG.png 975w,
/static/fd9b04a49f5a71c62f78bca3cb0c713e/3c492/p3My5nG.png 1300w,
/static/fd9b04a49f5a71c62f78bca3cb0c713e/d9ed5/p3My5nG.png 2880w"
        sizes="(max-width: 650px) 100vw, 650px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span>
However, the encoding string has something to do with timestamp, so the best way is to generate the encoding ourself every time we want to send the login request. For more information about the encoding that instagram made, checkout github forum. Some geeks are working on it.</p>
<h3>Get Instagram Feed</h3>
<deckgo-highlight-code language="python"  >
          <code slot="code">req_feed = session.get(BASE_URL)
session.headers.update({&#39;x-csrftoken&#39;:req_feed.cookies[&#39;csrftoken&#39;]})

raw_content = req_feed.text

# parse data by treating some keywords as position anchor
CONFIG_KEYWORD = &quot;window._sharedData = &quot;
config_start_pos = raw_content.find(CONFIG_KEYWORD) + len(CONFIG_KEYWORD)
config_end_pos = raw_content.find(&quot;&lt;/script&gt;&quot;,config_start_pos) - 1

FEED_KEYWORD = &quot;window.__additionalDataLoaded(&#39;feed&#39;,&quot;
feed_start_pos = raw_content.find(FEED_KEYWORD,config_end_pos) + len(FEED_KEYWORD)
feed_end_pos = raw_content.find(&quot;&lt;/script&gt;&quot;,feed_start_pos) - 2

data_config = json.loads(raw_content[config_start_pos:config_end_pos])
data_feed = json.loads(raw_content[feed_start_pos:feed_end_pos])

# save data to files
fp = codecs.open(&#39;data_config.json&#39;, &#39;w&#39;, &#39;utf-8&#39;)
fp.write(json.dumps(data_config,ensure_ascii=False))
fp.close()

fp = codecs.open(&#39;data_feed.json&#39;, &#39;w&#39;, &#39;utf-8&#39;)
fp.write(json.dumps(data_feed,ensure_ascii=False))
fp.close()</code>
        </deckgo-highlight-code>
<h3>Like/Unlike a post</h3>
<h4>Like</h4>
<p>After Pressing Like Button:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69.93865030674846%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVQ4y31Ty47TQBD0h7BJHNtrJ37P23YCq8CFA0JCAiGBuPL/X1CoeuLdZLXiUOrumU51VXuSnL/+wf78DfX0CX3boGk7hGnGPJ8QpkXgw4RJ8hmjMlCEttC3MFbuki+//2L4/AuNf8LHywXLcobzM4wLsC7A+Ulqxmk+CTiEhF03oOvHZwyDQvLzx3e8XyZUZQljA6blBOUd8vyANHvELs2x3WUS032BXVpIvtlmeNikz3j3kCLLHpF8eLqgeKwEPixC2I8aTTuiHw3Kqhak+0i8gqS32O5y5EWJZLPdy4S8qOD9LJaUsmi7EU07oCiPyPIS+6va/4FDEzZyIu0Y6+FDJJ2XM6ybMCgHbSdRzOGrunu1MaZpjoRELEistYM2XqwSo3Zoe32tLcpDc7fTW/tR1A0hozZOlA2jkZpD+GHWPCuqN9S91K8UFlDGy4fRNqDrldhsuhFtp9ANOqLXaPtYM/KubgZ0g8Gxbu8V0poyAdYv0CbIAJIbN8s581F7WYWxk9TrOfdcN/1rQgsXTnLJHzIaF7HuVJlIQkJ+MA7j+ahcJFyfAwlpj0SDsmJJGkWRF7WSKxcVuvnaE/sphnVCMr5DRu5nUO5KEK2vOQlW6yt4L5ZNtEwXCf+DfMTVocbh2IrsY93FvH3JCT501lw+I3vv+xr8A2fqrIWnr3LdAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="JFkf5jJ"
        title="JFkf5jJ"
        src="/static/aa71c22b74b138cff97dd6faad0f0148/a6d36/JFkf5jJ.png"
        srcset="/static/aa71c22b74b138cff97dd6faad0f0148/222b7/JFkf5jJ.png 163w,
/static/aa71c22b74b138cff97dd6faad0f0148/ff46a/JFkf5jJ.png 325w,
/static/aa71c22b74b138cff97dd6faad0f0148/a6d36/JFkf5jJ.png 650w,
/static/aa71c22b74b138cff97dd6faad0f0148/e548f/JFkf5jJ.png 975w,
/static/aa71c22b74b138cff97dd6faad0f0148/3c492/JFkf5jJ.png 1300w,
/static/aa71c22b74b138cff97dd6faad0f0148/b8bf8/JFkf5jJ.png 1728w"
        sizes="(max-width: 650px) 100vw, 650px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<deckgo-highlight-code language="python"  >
          <code slot="code"># like
POST_ID = &lt;postID&gt;
LIKE_URL = &quot;https://www.instagram.com/web/likes/{}/like/&quot;.format(POST_ID)

req_like = session.post(LIKE_URL,allow_redirects = True)
session.headers.update({&#39;x-csrftoken&#39;:req_like.cookies[&#39;csrftoken&#39;]})
print(req_like.text)</code>
        </deckgo-highlight-code>
<h4>Unlike</h4>
<deckgo-highlight-code language="python"  >
          <code slot="code">POST_ID = &lt;postID&gt;
UNLIKE_URL = &quot;https://www.instagram.com/web/likes/{}/unlike/&quot;.format(POST_ID)
req_unlike = session.post(UNLIKE_URL,allow_redirects = True)
session.headers.update({&#39;x-csrftoken&#39;:req_unlike.cookies[&#39;csrftoken&#39;]})
print(req_unlike.text)</code>
        </deckgo-highlight-code>
<h2>💯 Conclusion</h2>
<ol>
<li>Concept of web crawler</li>
<li>Concept of web request and response</li>
<li>Implementation of crawler in python</li>
<li>Parsing html code in python</li>
<li>Concept of CSRF token</li>
<li>Hands-on experiment on instagram crawling.</li>
</ol>
<h2>🚀 Some Directions For Futher Projects</h2>
<ol>
<li><a href="https://github.com/VeNoMouS/cloudscraper">cloudscraper</a></li>
<li>Posting Instagram Feed</li>
<li>Crawl Other Website</li>
<li>Hack the Encryption of instagram login</li>
</ol></div></div></main><footer style="margin-top:2rem;text-align:center">© <!-- -->2021<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.com">Gatsby</a> By Ian Shih</footer></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blogs/web-crawler-tutorial";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-8227c3bfdabf7a41ae12.js"],"app":["/app-0b1b4642d04bebea0301.js"],"component---src-pages-404-js":["/component---src-pages-404-js-37cc9f4dd354e5baf062.js"],"component---src-pages-about-js":["/component---src-pages-about-js-d7b9ea16f35b06571182.js"],"component---src-pages-blog-index-js":["/component---src-pages-blog-index-js-c7aa82c28beb6ece4d0c.js"],"component---src-pages-cv-js":["/component---src-pages-cv-js-a387e6b0d90775182cf9.js"],"component---src-pages-index-js":["/component---src-pages-index-js-90a756f4a75768b9e272.js"],"component---src-pages-survey-en-js":["/component---src-pages-survey-en-js-74df2954486334c5da22.js"],"component---src-pages-survey-js":["/component---src-pages-survey-js-5f2fc5ebe55a0fef63f8.js"],"component---src-pages-tags-index-js":["/component---src-pages-tags-index-js-ca32dc70d611be7a9741.js"],"component---src-templates-blog-details-js":["/component---src-templates-blog-details-js-824510c1beeaadccc353.js"],"component---src-templates-blog-tags-js":["/component---src-templates-blog-tags-js-16f0f3002f1c7edb20d3.js"]};/*]]>*/</script><script src="/polyfill-8227c3bfdabf7a41ae12.js" nomodule=""></script><script src="/component---src-templates-blog-details-js-824510c1beeaadccc353.js" async=""></script><script src="/9e6ea4d975805858d07c04bb43dd1fddf394f5b1-f46da138f29cb1f8c969.js" async=""></script><script src="/36d7c21d1e4b7fa3fc10cf7859aa9fac2846a677-d9991990319625a2a358.js" async=""></script><script src="/commons-b1815e83bd1939b4b650.js" async=""></script><script src="/app-0b1b4642d04bebea0301.js" async=""></script><script src="/framework-be1551205b2666f6b545.js" async=""></script><script src="/webpack-runtime-8bfdfe929912fb0982bb.js" async=""></script></body></html>